{"version":3,"sources":["../../../src/verification/index.ts"],"sourcesContent":["/**\n * Verification Security Module - Entry Point\n * \n * This module provides a comprehensive security enforcement system\n * for agent truth verification with enterprise-grade security features.\n */\n\n// Main security system\nexport {\n  SecurityEnforcementSystem as default,\n  SecurityEnforcementSystem \n} from './security.js';\n\n// Individual security components\nexport {\n  AgentAuthenticationSystem,\n  AdvancedRateLimiter,\n  AuditTrailSystem,\n  ByzantineFaultToleranceSystem,\n  ThresholdSignatureSystem,\n  ZeroKnowledgeProofSystem,\n  CryptographicCore\n} from './security.js';\n\n// Types and interfaces\nexport * from './types.js';\n\n// Re-export verification interfaces for backward compatibility\nexport type {\n  AgentIdentity,\n  VerificationRequest,\n  VerificationResult,\n  AuditEntry,\n  SecurityMetrics\n} from './security.js';\n\n// Utility functions and constants\nexport { SECURITY_CONSTANTS } from './types.js';\n\n// Error classes\nexport {\n  SecurityError,\n  AuthenticationError,\n  ByzantineError,\n  CryptographicError,\n  RateLimitError\n} from './types.js';\n\n// Truth DB Adapter for persistent storage\nexport {\n  TruthDBAdapter,\n  truthDBAdapter,\n  type TruthScoreDocument,\n  type SnapshotDocument\n} from './truth-db-adapter.js';\n\n// Verification Hooks (with persistence)\nexport {\n  VerificationHookManager,\n  verificationHookManager,\n  type VerificationConfig,\n  type VerificationContext,\n  type StateSnapshot\n} from './hooks.js';\n\n\n/**\n * Factory function to create a configured security system\n */\nexport function createSecuritySystem(config?: {\n  totalNodes?: number;\n  threshold?: number;\n  rateLimits?: {\n    perSecond?: number;\n    perMinute?: number;\n    perHour?: number;\n    perDay?: number;\n  };\n}): SecurityEnforcementSystem {\n  const totalNodes = config?.totalNodes || 5;\n  const threshold = config?.threshold || Math.floor((totalNodes * 2) / 3) + 1;\n  \n  const securitySystem = new SecurityEnforcementSystem(totalNodes, threshold);\n  \n  // Configure rate limits if provided\n  if (config?.rateLimits) {\n    // This would be implemented as a method on SecurityEnforcementSystem\n    // For now, it's a placeholder for future implementation\n    console.log('Custom rate limits configured:', config.rateLimits);\n  }\n  \n  return securitySystem;\n}\n\n/**\n * Quick setup function for development environments\n */\nexport function createDevelopmentSecuritySystem(): SecurityEnforcementSystem {\n  return createSecuritySystem({\n    totalNodes: 3,\n    threshold: 2,\n    rateLimits: {\n      perSecond: 100,\n      perMinute: 1000,\n      perHour: 10000,\n      perDay: 100000\n    }\n  });\n}\n\n/**\n * Production-ready security system with strict settings\n */\nexport function createProductionSecuritySystem(): SecurityEnforcementSystem {\n  return createSecuritySystem({\n    totalNodes: 7,\n    threshold: 5,\n    rateLimits: {\n      perSecond: 10,\n      perMinute: 100,\n      perHour: 1000,\n      perDay: 10000\n    }\n  });\n}\n\n/**\n * High-security system for sensitive environments\n */\nexport function createHighSecuritySystem(): SecurityEnforcementSystem {\n  return createSecuritySystem({\n    totalNodes: 9,\n    threshold: 7,\n    rateLimits: {\n      perSecond: 5,\n      perMinute: 50,\n      perHour: 500,\n      perDay: 5000\n    }\n  });\n}\n\n// ===== CLI Integration =====\nexport {\n  VerificationCLICommands,\n  createVerificationCommand,\n  executeVerificationFromCLI\n} from './cli-integration.js';"],"names":["SecurityEnforcementSystem","default","AgentAuthenticationSystem","AdvancedRateLimiter","AuditTrailSystem","ByzantineFaultToleranceSystem","ThresholdSignatureSystem","ZeroKnowledgeProofSystem","CryptographicCore","SECURITY_CONSTANTS","SecurityError","AuthenticationError","ByzantineError","CryptographicError","RateLimitError","TruthDBAdapter","truthDBAdapter","VerificationHookManager","verificationHookManager","createSecuritySystem","config","totalNodes","threshold","Math","floor","securitySystem","rateLimits","console","log","createDevelopmentSecuritySystem","perSecond","perMinute","perHour","perDay","createProductionSecuritySystem","createHighSecuritySystem","VerificationCLICommands","createVerificationCommand","executeVerificationFromCLI"],"mappings":"AAQA,SACEA,6BAA6BC,OAAO,EACpCD,yBAAyB,QACpB,gBAAgB;AAGvB,SACEE,yBAAyB,EACzBC,mBAAmB,EACnBC,gBAAgB,EAChBC,6BAA6B,EAC7BC,wBAAwB,EACxBC,wBAAwB,EACxBC,iBAAiB,QACZ,gBAAgB;AAGvB,cAAc,aAAa;AAY3B,SAASC,kBAAkB,QAAQ,aAAa;AAGhD,SACEC,aAAa,EACbC,mBAAmB,EACnBC,cAAc,EACdC,kBAAkB,EAClBC,cAAc,QACT,aAAa;AAGpB,SACEC,cAAc,EACdC,cAAc,QAGT,wBAAwB;AAG/B,SACEC,uBAAuB,EACvBC,uBAAuB,QAIlB,aAAa;AAMpB,OAAO,SAASC,qBAAqBC,MASpC;IACC,MAAMC,aAAaD,QAAQC,cAAc;IACzC,MAAMC,YAAYF,QAAQE,aAAaC,KAAKC,KAAK,CAAC,AAACH,aAAa,IAAK,KAAK;IAE1E,MAAMI,iBAAiB,IAAIzB,0BAA0BqB,YAAYC;IAGjE,IAAIF,QAAQM,YAAY;QAGtBC,QAAQC,GAAG,CAAC,kCAAkCR,OAAOM,UAAU;IACjE;IAEA,OAAOD;AACT;AAKA,OAAO,SAASI;IACd,OAAOV,qBAAqB;QAC1BE,YAAY;QACZC,WAAW;QACXI,YAAY;YACVI,WAAW;YACXC,WAAW;YACXC,SAAS;YACTC,QAAQ;QACV;IACF;AACF;AAKA,OAAO,SAASC;IACd,OAAOf,qBAAqB;QAC1BE,YAAY;QACZC,WAAW;QACXI,YAAY;YACVI,WAAW;YACXC,WAAW;YACXC,SAAS;YACTC,QAAQ;QACV;IACF;AACF;AAKA,OAAO,SAASE;IACd,OAAOhB,qBAAqB;QAC1BE,YAAY;QACZC,WAAW;QACXI,YAAY;YACVI,WAAW;YACXC,WAAW;YACXC,SAAS;YACTC,QAAQ;QACV;IACF;AACF;AAGA,SACEG,uBAAuB,EACvBC,yBAAyB,EACzBC,0BAA0B,QACrB,uBAAuB"}